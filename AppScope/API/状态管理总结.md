# 状态管理（V1）
## 管理组件拥有的状态
@State:组件内状态(状态变量),可以触发直接绑定的UI组件的刷新,状态改变,UI发生渲染改变 ,
1. 与声明式范式中的其他被装饰变量一样，是私有的，只能从组件内部访问，在声明时必须指定其类型和本地初始化
2. 当装饰的数据类型为boolean、string、number类型时，可以观察到数值的变化。
3. 当装饰的数据类型为class或者Object时，可以观察到自身的赋值的变化，和其属性赋值的变化，即Object.keys(observedObject)返回的所有属性。(嵌套属性的赋值观察不到。)
4. 当装饰的对象是array时，可以观察到数组本身的赋值和添加、删除、更新数组的变化。(一级属性)
5. 当装饰的对象是Date时，可以观察到Date整体的赋值
6. 当装饰的变量是Map时，可以观察到Map整体的赋值，同时可通过调用Map的接口set, clear, delete 更新Map的值。
7. 当装饰的变量是Set时，可以观察到Set整体的赋值，同时可通过调用Set的接口add, clear, delete 更新Set的值


**使用场景**
* 装饰简单类型的变量(Object、class、string、number、boolean、enum,Date,Map,Set,Length、ResourceStr、ResourceColor)以及这些类型的数组还支持(null,undefine)
* 装饰class对象类型的变量(具有 独立性(各自渲染))
* 装饰Map类型变量
* State支持联合类型实例
* 状态变量只能影响其直接绑定的UI组件的刷新

@Prop装饰的变量可以和父组件建立单向的同步关系。@Prop装饰的变量是可变的，但是变化不会同步回其父组件。
@Prop装饰的变量和父组件建立单向的同步关系：
* @Prop变量允许在本地修改，但修改后的变化不会同步回父组件。
* 当数据源更改时，@Prop装饰的变量都会更新，并且会覆盖本地所有更改。因此，数值的同步是父组件到子组件（所属组件)，子组件数值的变化不会同步到父组件。
 
**限制条件**
@Prop装饰变量时会进行深拷贝，在拷贝的过程中除了基本类型、Map、Set、Date、Array外，都会丢失类型。例如PixelMap等通过NAPI提供的复杂类型，由于有部分实现在Native侧，因此无法在ArkTS侧通过深拷贝获得完整的数据。
@State和@Prop的同步场景：
* 使用父组件中@State变量的值初始化子组件中的@Prop变量。当@State变量变化时，该变量值也会同步更新至@Prop变量。
* @Prop装饰的变量的修改不会影响其数据源@State装饰变量的值。
* 除了@State，数据源也可以用@Link或@Prop装饰，对@Prop的同步机制是相同的。
* 数据源和@Prop变量的类型需要相同，@Prop允许简单类型和class类型。
* 当装饰的对象是Date时，可以观察到Date整体的赋值，同时可通过调用Date的接口setFullYear, setMonth, setDate, setHours, setMinutes, setSeconds, setMilliseconds, setTime, setUTCFullYear, setUTCMonth, setUTCDate, setUTCHours, setUTCMinutes, setUTCSeconds, setUTCMilliseconds 更新Date的属性。
* 当装饰的变量是Map时，可以观察到Map整体的赋值，同时可通过调用Map的接口set, clear, delete 更新Map的值
* 当装饰的变量是Set时，可以观察到Set整体的赋值，同时可通过调用Set的接口add, clear, delete 更新Set的值。

**_**框架行为**_**
初始渲染：
执行父组件的build()函数将创建子组件的新实例，将数据源传递给子组件。
初始化子组件@Prop装饰的变量。
更新：
子组件@Prop更新时，更新仅停留在当前子组件，不会同步回父组件。
当父组件的数据源更新时，子组件的@Prop装饰的变量将被来自父组件的数据源重置，所有@Prop装饰的本地的修改将被父组件的更新覆盖。

**使用场景**
父组件@State到子组件@Prop简单数据类型同步
父组件@State数组项到子组件@Prop简单数据类型同步
从父组件中的@State类对象属性到@Prop简单类型的同步
从父组件中的@State数组项到@Prop class类型的同步(嵌套的第二层使用@observe)
@Prop本地初始化不和父组件同步
@Prop嵌套场景(每一层都要用@Observed装饰，且每一层都要被@Prop接收)
装饰Map类型变量
装饰Set类型变量

#### @Link装饰器：父子双向同步

